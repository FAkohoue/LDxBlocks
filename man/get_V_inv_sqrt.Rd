% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_V_inv_sqrt.R
\name{get_V_inv_sqrt}
\alias{get_V_inv_sqrt}
\title{Compute the Inverse Square Root (Whitening) of a Kinship Matrix}
\usage{
get_V_inv_sqrt(V, rV2method = c("chol", "eigen"))
}
\arguments{
\item{V}{A symmetric, numeric matrix of dimension \eqn{n \times n} (typically a kinship matrix).}

\item{rV2method}{Character string specifying the decomposition:
\itemize{
\item \code{"chol"} (default): Cholesky factorization. If \eqn{V = R^\top R} (R from \code{chol}),
this returns \eqn{A = R^{-1}} (via \code{backsolve}). Fast and stable.
\item \code{"eigen"}: Eigen decomposition. If \eqn{V = Q \Lambda Q^\top}, returns
\eqn{A = Q\,\Lambda^{-1/2}\,Q^\top}. Eigenvalues are thresholded at \code{1e-6}.
}}
}
\value{
A numeric matrix \eqn{A} of the same dimension as \code{V} such that \eqn{A\,V\,A^\top=I}.
}
\description{
Returns a matrix \eqn{A} that whitens a positive-definite matrix \eqn{V}:
\deqn{A\, V\, A^\top = I.}
This is used to decorrelate centered genotype data prior to kinship-adjusted LD
estimation (\eqn{rV^2}) or mixed-model transforms.
}
\details{
The Cholesky-based \eqn{A} is not symmetric but satisfies \eqn{A\,V\,A^\top=I} and is standard for
whitening vectors by left-multiplication (\eqn{X^* = A X}). The eigen-based \eqn{A} is symmetric
and also satisfies \eqn{A\,V\,A^\top=I}.
}
\examples{
\donttest{
set.seed(1)
G <- matrix(rnorm(100 * 20), nrow = 100, ncol = 20)
Gc <- scale(G, center = TRUE, scale = FALSE)
kin <- crossprod(Gc) / ncol(G)  # simple kinship
A_chol <- get_V_inv_sqrt(kin, rV2method = "chol")
A_eig  <- get_V_inv_sqrt(kin, rV2method = "eigen")
}

}
\seealso{
\code{\link{compute_rV2}}, \code{\link{CLQD}}, \code{\link{Big_LD}}, \code{\link{eigen}}, \code{\link{chol}}
}
